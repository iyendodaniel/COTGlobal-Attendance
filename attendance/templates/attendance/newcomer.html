{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>New-member — Add Member</title>
  <link rel="stylesheet" href="{% static 'attendance/css/styles.css' %}" />
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="brand">
        <h1>New-member</h1>
        <p class="lead">Add a new-member quickly.</p>
      </div>
      <nav class="nav">
        <a href="{% url 'home' %}">Home</a>
        <a href="{% url 'new_member' %}" class="active">New-member</a>
        <a href="{% url 'existing_member' %}">Existing-member</a>
        <a href="{% url 'complete_profile' %}">Complete Profile</a>
        <a href="{% url 'admin' %}">Admin</a>
        <a href="{% url 'download_page' %}">Download</a>
      </nav>
    </header>
    <form action="{% url 'logout' %}" method="post">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger">Logout</button>
    </form>

    <main class="panel">
      <h2 class="h2">New-member Form</h2>
      <form id="form" class="form" method="POST" action="{% url 'new_member' %}">
      {% csrf_token %}
        <div class="grid">
          <div class="field">
            <label for="name">Full name</label>
            <input id="name" name="name" class="input" required minlength="2" required/>
            <p class="error" data-err="name"></p>
          </div>

          <div class="field">
            <label for="role">Role</label>
            <select id="role" name= "role"class="input" required style="color: #4960aa;">
              <option value="New_Member">New Member</option>
            </select>
            <p class="error" data-err="role"></p>
          </div>

          <div class="field" id="phone-field">
            <label for="phone">Phone number</label>
            <input id="phone" name="phone" class="input" type="tel" required pattern="^[0-9 \-()+]{6,}$" required/>
            <p class="error" data-err="phone"></p>
          </div>
        </div>

        <!-- Action buttons -->
        <div class="actions" style="margin-top: 12px">
          <button type="submit" class="btn">Submit</button>
          <button type="button" id="clear" class="btn ghost">Clear</button>
          {% if member %}
          <span
              id="msg"
              class="badge"
              style="background: rgba(16, 185, 129, 0.12)"
          >New Member added.</span>
          {% endif %}
        </div>

        {% if messages %}
          {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {% endfor %}
        {% endif %}


        <!-- SUCCESS — NEW MEMBER REGISTERED -->
        {% if member %}
        <div class="result-box success">
            <h3 style="color: #0d6323;">Member Registered Successfully</h3>
            <p><strong>Name:</strong> {{member.name}}</p>
            <p><strong>Phone Number:</strong> {{member.phone_number}}</p>
        </div>
        {% endif %}

        <script>
        document.addEventListener("DOMContentLoaded", () => {
            const clearBtn = document.getElementById("clear");
            const form = document.getElementById("form");
            clearBtn.addEventListener("click", () => {
                form.reset();
                const successBox = document.querySelector(".result-box.success");
                const msgBadge = document.getElementById("msg");
                if (successBox) successBox.style.display = "none";
                if (msgBadge) msgBadge.style.display = "none";
            });
        });
        </script>
</body>
</html>